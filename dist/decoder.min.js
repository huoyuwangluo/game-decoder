var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},amf;!function(t){var e={EMPTY_STRING:"",NULL_STRING:"null",UNDEFINED_TYPE:0,NULL_TYPE:1,FALSE_TYPE:2,TRUE_TYPE:3,INTEGER_TYPE:4,DOUBLE_TYPE:5,STRING_TYPE:6,XML_TYPE:7,DATE_TYPE:8,ARRAY_TYPE:9,OBJECT_TYPE:10,XMLSTRING_TYPE:11,BYTEARRAY_TYPE:12,AMF0_AMF3:17,UINT29_MASK:536870911,INT28_MAX_VALUE:268435455,INT28_MIN_VALUE:-268435456,CLASS_ALIAS:"_explicitType",EXTERNALIZED_FIELD:"_externalizedData"},i=function(){function t(){this._explicitType="flex.messaging.io.amf.ActionMessage",this.version=3,this.headers=[],this.bodies=[]}return t}();t.ActionMessage=i,__reflect(i.prototype,"amf.ActionMessage");var r=function(){function t(){this.targetURI="null",this.responseURI="/1",this.data=[]}return t}();t.MessageBody=r,__reflect(r.prototype,"amf.MessageBody");var s=function(){function t(){this.name="",this.mustUnderstand=!1,this.data=null}return t}();t.MessageHeader=s,__reflect(s.prototype,"amf.MessageHeader");var n=function(){function t(){this._explicitType="flex.messaging.messages.CommandMessage",this.destination="",this.operation=5,this.clientId=null}return t}();t.CommandMessage=n,__reflect(n.prototype,"amf.CommandMessage");var o=function(){function t(){this._explicitType="flex.messaging.messages.RemotingMessagee",this.destination="",this.source="",this.operation="",this.body=[],this.headers={DSId:"nil"},this.clientId=null}return t}();t.RemotingMessage=o,__reflect(o.prototype,"amf.RemotingMessage");var a=function(){function t(){this._explicitType="flex.messaging.messages.AcknowledgeMessage",this.body=null,this.headers=[],this.messageId=null,this.clientId=null}return t}();t.AcknowledgeMessage=a,__reflect(a.prototype,"amf.AcknowledgeMessage");var h=function(){function t(t,e,i,r,s,n,o){this.source=t,this.operation=e,this.params=i,this.onResult=r,this.onStatus=s,this.token=n,this.holdQueue=o}return t}();t.Request=h,__reflect(h.prototype,"amf.Request");var u=function(){function t(){this.write=function(t){this.data.push(t)},this.writeShort=function(t){this.write(t>>>8&255),this.write(t>>>0&255)},this.writeUTF=function(t,e){var i,r,s,n,o;for(n=t.length,o=0,s=0;n>s;s++)r=t.charCodeAt(s),r>0&&128>r?o++:o+=r>2047?3:2;for(i=[],e?this.writeUInt29(o<<1|1):(i.push(o>>>8&255),i.push(255&o)),s=0;n>s;s++)r=t.charCodeAt(s),r>0&&128>r?i.push(r):r>2047?(i.push(224|r>>12),i.push(128|r>>6&63),e?i.push(128|r>>0&63):i.push(128|63&r)):(i.push(192|r>>6),e?i.push(128|r>>0&63):i.push(128|63&r));return this.writeAll(i),e?o:o+2},this.writeUInt29=function(t){if(128>t)this.write(t);else if(16384>t)this.write(t>>7&127|128),this.write(127&t);else if(2097152>t)this.write(t>>14&127|128),this.write(t>>7&127|128),this.write(127&t);else{if(!(1073741824>t))throw"Integer out of range: "+t;this.write(t>>22&127|128),this.write(t>>15&127|128),this.write(t>>8&127|128),this.write(255&t)}},this.writeAll=function(t){for(var e=0;e<t.length;e++)this.write(t[e])},this.writeBoolean=function(t){this.write(t?1:0)},this.writeInt=function(t){this.write(t>>>24&255),this.write(t>>>16&255),this.write(t>>>8&255),this.write(t>>>0&255)},this.writeUnsignedInt=function(t){0>t&&(t=-(4294967295^t)-1),t&=4294967295,this.write(t>>24&255),this.write(t>>16&255),this.write(t>>8&255),this.write(255&t)},this._getDouble=function(t){var e=[0,0];if(t!=t)return e[0]=-524288,e;var i=0>t||0===t&&0>1/t?-2147483648:0,t=Math.abs(t);if(t===Number.POSITIVE_INFINITY)return e[0]=2146435072|i,e;for(var r=0;t>=2&&1023>=r;)r++,t/=2;for(;1>t&&r>=-1022;)r--,t*=2;if(r+=1023,2047==r)return e[0]=2146435072|i,e;var s;return 0==r?(s=t*Math.pow(2,23)/2,t=Math.round(t*Math.pow(2,52)/2)):(s=t*Math.pow(2,20)-Math.pow(2,20),t=Math.round(t*Math.pow(2,52)-Math.pow(2,52))),e[0]=i|r<<20&2147418112|1048575&s,e[1]=t,e},this.writeDouble=function(t){t=this._getDouble(t),this.writeUnsignedInt(t[0]),this.writeUnsignedInt(t[1])},this.getResult=function(){return this.data.join("")},this.reset=function(){this.objects=[],this.objectCount=0,this.traits={},this.traitCount=0,this.strings={},this.stringCount=0},this.writeStringWithoutType=function(t){0==t.length?this.writeUInt29(1):this.stringByReference(t)||this.writeUTF(t,!0)},this.stringByReference=function(t){var e=this.strings[t];return e?this.writeUInt29(e<<1):this.strings[t]=this.stringCount++,e},this.objectByReference=function(t){for(var e=0,i=!1;e<this.objects.length;e++)if(this.objects[e]===t){i=!0;break}return i?this.writeUInt29(e<<1):(this.objects.push(t),this.objectCount++),i?e:null},this.traitsByReference=function(t,e){for(var i=e+"|",r=0;r<t.length;r++)i+=t[r]+"|";var s=this.traits[i];return s?this.writeUInt29(s<<2|1):this.traits[i]=this.traitCount++,s},this.writeAmfInt=function(t){t>=e.INT28_MIN_VALUE&&t<=e.INT28_MAX_VALUE?(t&=e.UINT29_MASK,this.write(e.INTEGER_TYPE),this.writeUInt29(t)):(this.write(e.DOUBLE_TYPE),this.writeDouble(t))},this.writeDate=function(t){this.write(e.DATE_TYPE),this.objectByReference(t)||(this.writeUInt29(1),this.writeDouble(t.getTime()))},this.writeObject=function(t){return null==t?void this.write(e.NULL_TYPE):void(t.constructor===String?(this.write(e.STRING_TYPE),this.writeStringWithoutType(t)):t.constructor===Number?t===+t&&t===(0|t)?this.writeAmfInt(t):(this.write(e.DOUBLE_TYPE),this.writeDouble(t)):t.constructor===Boolean?this.write(t?e.TRUE_TYPE:e.FALSE_TYPE):t.constructor===Date?this.writeDate(t):t.constructor===Array?this.writeArray(t):e.CLASS_ALIAS in t?this.writeCustomObject(t):this.writeMap(t))},this.writeCustomObject=function(t){if(this.write(e.OBJECT_TYPE),!this.objectByReference(t))for(var i=this.writeTraits(t),r=0;r<i.length;r++){var s=i[r];this.writeObject(t[s])}},this.writeTraits=function(t){var i=[],r=0,s=!1,n=!1;for(var o in t)o!=e.CLASS_ALIAS&&(i.push(o),r++);if(!this.traitsByReference(i,t[e.CLASS_ALIAS])&&(this.writeUInt29(3|(s?4:0)|(n?8:0)|r<<4),this.writeStringWithoutType(t[e.CLASS_ALIAS]),r>0))for(var a in i)this.writeStringWithoutType(i[a]);return i},this.writeMap=function(t){if(this.write(e.OBJECT_TYPE),!this.objectByReference(t)){this.writeUInt29(11),this.traitCount++,this.writeStringWithoutType(e.EMPTY_STRING);for(var i in t)i?this.writeStringWithoutType(i):this.writeStringWithoutType(e.EMPTY_STRING),this.writeObject(t[i]);this.writeStringWithoutType(e.EMPTY_STRING)}},this.writeArray=function(t){if(this.write(e.ARRAY_TYPE),!this.objectByReference(t)&&(this.writeUInt29(t.length<<1|1),this.writeUInt29(1),t.length>0))for(var i=0;i<t.length;i++)this.writeObject(t[i])},this.data=[],this.objects=[],this.traits={},this.strings={},this.stringCount=0,this.traitCount=0,this.objectCount=0}return t}();t.Writer=u,__reflect(u.prototype,"amf.Writer");var f=function(){function t(t){this.read=function(){return this.data[this.pos++]},this.readUnsignedShort=function(){var t=this.read(),e=this.read();return(t<<8)+(e<<0)},this.readUInt29=function(){var t=255&this.read();if(128>t)return t;var e=(127&t)<<7;return t=255&this.read(),128>t?e|t:(e=(e|127&t)<<7,t=255&this.read(),128>t?e|t:(e=(e|127&t)<<8,t=255&this.read(),e|t))},this.readFully=function(t,e,i){for(var r=e;i>r;r++)t[r]=this.read()},this.readUTF=function(t){for(var e,i,r,s=t?t:this.readUnsignedShort(),n=[],o=this.pos;this.pos<o+s;)switch(e=this.read(),e>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n.push(String.fromCharCode(e));break;case 12:case 13:i=this.read(),n.push(String.fromCharCode((31&e)<<6|63&i));break;case 14:i=this.read(),r=this.read(),n.push(String.fromCharCode((15&e)<<12|(63&i)<<6|(63&r)<<0));break;case 8:case 9:case 10:case 11:}return n.join("")},this.reset=function(){this.objects=[],this.traits=[],this.strings=[]},this.readObject=function(){var t=this.read();return this.readObjectValue(t)},this.readString=function(){var t=this.readUInt29();if(0==(1&t))return this.getString(t>>1);var i=t>>1;if(0==i)return e.EMPTY_STRING;var r=this.readUTF(i);return this.rememberString(r),r},this.rememberString=function(t){this.strings.push(t)},this.getString=function(t){return this.strings[t]},this.getObject=function(t){return this.objects[t]},this.getTraits=function(t){return this.traits[t]},this.rememberTraits=function(t){this.traits.push(t)},this.rememberObject=function(t){this.objects.push(t)},this.readTraits=function(t){if(1==(3&t))return this.getTraits(t>>2);var i=t>>4,r=this.readString(),s={};null!=r&&""!=r&&(s[e.CLASS_ALIAS]=r),s.props=[];for(var n=0;i>n;n++)s.props.push(this.readString());return this.rememberTraits(s),s},this.readScriptObject=function(){var t=this.readUInt29();if(0==(1&t))return this.getObject(t>>1);var i=this.readTraits(t),r={};if(e.CLASS_ALIAS in i&&(r[e.CLASS_ALIAS]=i[e.CLASS_ALIAS]),this.rememberObject(r),4==(4&t)){if("flex.messaging.io.ArrayCollection"==r[e.CLASS_ALIAS]||"flex.messaging.io.ObjectProxy"==r[e.CLASS_ALIAS])return this.readObject();r[e.EXTERNALIZED_FIELD]=this.readObject()}else{for(var s in i.props)r[i.props[s]]=this.readObject();if(8==(8&t))for(;;){var n=this.readString();if(null==n||0==n.length)break;r[n]=this.readObject()}}return r},this.readArray=function(){var t=this.readUInt29();if(0==(1&t))return this.getObject(t>>1);for(var e=t>>1,i=null,r=0;;){var s=this.readString();if(!s)break;i||(i={},this.rememberObject(i)),i[s]=this.readObject()}if(i){for(r=0;e>r;r++)i[r]=this.readObject();return i}var n=new Array(e);for(this.rememberObject(n),r=0;e>r;r++)n[r]=this.readObject();return n},this.readDouble=function(){var t=255&this.read(),e=255&this.read();if(255===t){if(248===e)return Number.NaN;if(240===e)return Number.NEGATIVE_INFINITY}else if(127===t&&240===e)return Number.POSITIVE_INFINITY;var i=255&this.read(),r=255&this.read(),s=255&this.read(),n=255&this.read(),o=255&this.read(),a=255&this.read();if(!(t||e||i||r))return 0;for(var h=(t<<4&2047|e>>4)-1023,e=((15&e)<<16|i<<8|r).toString(2),i=e.length;20>i;i++)e="0"+e;for(n=((127&s)<<24|n<<16|o<<8|a).toString(2),i=n.length;31>i;i++)n="0"+n;return s=parseInt(e+(s>>7?"1":"0")+n,2),0==s&&-1023==h?0:(1-(t>>7<<1))*(1+Math.pow(2,-52)*s)*Math.pow(2,h)},this.readDate=function(){var t=this.readUInt29();if(0==(1&t))return this.getObject(t>>1);var e=this.readDouble(),i=new Date(e);return this.rememberObject(i),i},this.readMap=function(){var t=this.readUInt29();if(0==(1&t))return this.getObject(t>>1);var e=t>>1,i=null;if(e>0){i={},this.rememberObject(i);for(var r=this.readObject();null!=r;)i[r]=this.readObject(),r=this.readObject()}return i},this.readByteArray=function(){var t=this.readUInt29();if(0==(1&t))return this.getObject(t>>1);var e=t>>1,i=[];return this.readFully(i,0,e),this.rememberObject(i),i},this.readObjectValue=function(t){var i=null;switch(t){case e.STRING_TYPE:i=this.readString();break;case e.OBJECT_TYPE:try{i=this.readScriptObject()}catch(r){throw"Failed to deserialize:"+r}break;case e.ARRAY_TYPE:i=this.readArray();break;case e.FALSE_TYPE:i=!1;break;case e.TRUE_TYPE:i=!0;break;case e.INTEGER_TYPE:i=this.readUInt29(),i=i<<3>>3;break;case e.DOUBLE_TYPE:i=this.readDouble();break;case e.UNDEFINED_TYPE:case e.NULL_TYPE:break;case e.DATE_TYPE:i=this.readDate();break;case e.BYTEARRAY_TYPE:i=this.readByteArray();break;case e.AMF0_AMF3:i=this.readObject();break;default:throw"Unknown AMF type: "+t}return i},this.readBoolean=function(){return 1===this.read()},this.objects=[],this.traits=[],this.strings=[],this.data=t,this.pos=0}return t}();t.Reader=f,__reflect(f.prototype,"amf.Reader");var d=function(){function t(){this.writeMessage=function(t){try{this.writer.writeShort(t.version),this.writer.writeShort(t.headers.length);for(var e in t.headers)this.writeHeader(t.headers[e]);this.writer.writeShort(t.bodies.length);for(var i in t.bodies)this.writeBody(t.bodies[i])}catch(r){console.log(r)}return this.writer.data},this.writeObject=function(t){this.writer.writeObject(t)},this.writeHeader=function(t){this.writer.writeUTF(t.name),this.writer.writeBoolean(t.mustUnderstand),this.writer.writeInt(1),this.writer.reset(),this.writer.write(1),this.writer.writeBoolean(!0)},this.writeBody=function(t){null==t.targetURI?this.writer.writeUTF(e.NULL_STRING):this.writer.writeUTF(t.targetURI),null==t.responseURI?this.writer.writeUTF(e.NULL_STRING):this.writer.writeUTF(t.responseURI),this.writer.writeInt(1),this.writer.reset(),this.writer.write(e.AMF0_AMF3),this.writeObject(t.data)},this.writer=new u}return t}();t.Serializer=d,__reflect(d.prototype,"amf.Serializer");var c=function(){function t(t){this.readMessage=function(){var t=new i;t.version=this.reader.readUnsignedShort();for(var e=this.reader.readUnsignedShort(),r=0;e>r;r++)t.headers.push(this.readHeader());var s=this.reader.readUnsignedShort();for(r=0;s>r;r++)t.bodies.push(this.readBody());return t},this.readHeader=function(){var t=new s;t.name=this.reader.readUTF(),t.mustUnderstand=this.reader.readBoolean(),this.reader.pos+=4,this.reader.reset();var e=this.reader.read();if(2!=e)throw"Only string header data supported.";return t.data=this.reader.readUTF(),t},this.readBody=function(){var t=new r;return t.targetURI=this.reader.readUTF(),t.responseURI=this.reader.readUTF(),this.reader.pos+=4,this.reader.reset(),t.data=this.readObject(),t},this.readObject=function(){return this.reader.readObject()},this.reader=new f(t)}return t}();t.Deserializer=c,__reflect(c.prototype,"amf.Deserializer")}(amf||(amf={}));var decoder;!function(t){var e=function(){function t(){}return t.LITTLE_ENDIAN="littleEndian",t.BIG_ENDIAN="bigEndian",t}();t.Endian=e,__reflect(e.prototype,"decoder.Endian");var i=function(){function t(t,i){void 0===i&&(i=0),this.bufferExtSize=0,this.EOF_byte=-1,this.EOF_code_point=-1,0>i&&(i=0),this.bufferExtSize=i;var r,s=0;if(t){var n=void 0;if(t instanceof Uint8Array?(n=t,s=t.length):(s=t.byteLength,n=new Uint8Array(t)),0==i)r=new Uint8Array(s);else{var o=(s/i|0)+1;r=new Uint8Array(o*i)}r.set(n)}else r=new Uint8Array(i);this.write_position=s,this._position=0,this._bytes=r,this.data=new DataView(r.buffer),this.endian=e.BIG_ENDIAN}return Object.defineProperty(t.prototype,"endian",{get:function(){return 0==this.$endian?e.LITTLE_ENDIAN:e.BIG_ENDIAN},set:function(t){this.$endian=t==e.LITTLE_ENDIAN?0:1},enumerable:!0,configurable:!0}),t.prototype.setArrayBuffer=function(t){},Object.defineProperty(t.prototype,"readAvailable",{get:function(){return this.write_position-this._position},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buffer",{get:function(){return this.data.buffer.slice(0,this.write_position)},set:function(t){var e,i=t.byteLength,r=new Uint8Array(t),s=this.bufferExtSize;if(0==s)e=new Uint8Array(i);else{var n=(i/s|0)+1;e=new Uint8Array(n*s)}e.set(r),this.write_position=i,this._bytes=e,this.data=new DataView(e.buffer)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rawBuffer",{get:function(){return this.data.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bytes",{get:function(){return this._bytes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataView",{get:function(){return this.data},set:function(t){this.buffer=t.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferOffset",{get:function(){return this.data.byteOffset},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,t>this.write_position&&(this.write_position=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this.write_position},set:function(t){this.write_position=t,this.data.byteLength>t&&(this._position=t),this._validateBuffer(t)},enumerable:!0,configurable:!0}),t.prototype._validateBuffer=function(t){if(this.data.byteLength<t){var e=this.bufferExtSize,i=void 0;if(0==e)i=new Uint8Array(t);else{var r=((t/e>>0)+1)*e;i=new Uint8Array(r)}i.set(this._bytes),this._bytes=i,this.data=new DataView(i.buffer)}},Object.defineProperty(t.prototype,"bytesAvailable",{get:function(){return this.data.byteLength-this._position},enumerable:!0,configurable:!0}),t.prototype.clear=function(){var t=new ArrayBuffer(this.bufferExtSize);this.data=new DataView(t),this._bytes=new Uint8Array(t),this._position=0,this.write_position=0},t.prototype.readBoolean=function(){return this.validate(1)?!!this._bytes[this.position++]:void 0},t.prototype.readByte=function(){return this.validate(1)?this.data.getInt8(this.position++):void 0},t.prototype.readBytes=function(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=0),t){var r=this._position,s=this.write_position-r;if(0>s)return void console.error(1025);if(0==i)i=s;else if(i>s)return void console.error(1025);t.validateBuffer(e+i),t._bytes.set(this._bytes.subarray(r,r+i),e),this.position+=i}},t.prototype.readDouble=function(){if(this.validate(8)){var t=this.data.getFloat64(this._position,0==this.$endian);return this.position+=8,t}},t.prototype.readFloat=function(){if(this.validate(4)){var t=this.data.getFloat32(this._position,0==this.$endian);return this.position+=4,t}},t.prototype.readInt=function(){if(this.validate(4)){var t=this.data.getInt32(this._position,0==this.$endian);return this.position+=4,t}},t.prototype.readShort=function(){if(this.validate(2)){var t=this.data.getInt16(this._position,0==this.$endian);return this.position+=2,t}},t.prototype.readUnsignedByte=function(){return this.validate(1)?this._bytes[this.position++]:void 0},t.prototype.readUnsignedInt=function(){if(this.validate(4)){var t=this.data.getUint32(this._position,0==this.$endian);return this.position+=4,t}},t.prototype.readUnsignedShort=function(){if(this.validate(2)){var t=this.data.getUint16(this._position,0==this.$endian);return this.position+=2,t}},t.prototype.readUTF=function(){var t=this.readUnsignedShort();return t>0?this.readUTFBytes(t):""},t.prototype.readUTFBytes=function(t){if(this.validate(t)){var e=this.data,i=new Uint8Array(e.buffer,e.byteOffset+this._position,t);return this.position+=t,this.decodeUTF8(i)}},t.prototype.writeBoolean=function(t){this.validateBuffer(1),this._bytes[this.position++]=+t},t.prototype.writeByte=function(t){this.validateBuffer(1),this._bytes[this.position++]=255&t},t.prototype.writeBytes=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var r;0>e||0>i||(r=0==i?t.length-e:Math.min(t.length-e,i),r>0&&(this.validateBuffer(r),this._bytes.set(t._bytes.subarray(e,e+r),this._position),this.position=this._position+r))},t.prototype.writeDouble=function(t){this.validateBuffer(8),this.data.setFloat64(this._position,t,0==this.$endian),this.position+=8},t.prototype.writeFloat=function(t){this.validateBuffer(4),this.data.setFloat32(this._position,t,0==this.$endian),this.position+=4},t.prototype.writeInt=function(t){this.validateBuffer(4),this.data.setInt32(this._position,t,0==this.$endian),this.position+=4},t.prototype.writeShort=function(t){this.validateBuffer(2),this.data.setInt16(this._position,t,0==this.$endian),this.position+=2},t.prototype.writeUnsignedInt=function(t){this.validateBuffer(4),this.data.setUint32(this._position,t,0==this.$endian),this.position+=4},t.prototype.writeUnsignedShort=function(t){this.validateBuffer(2),this.data.setUint16(this._position,t,0==this.$endian),this.position+=2},t.prototype.writeUTF=function(t){var e=this.encodeUTF8(t),i=e.length;this.validateBuffer(2+i),this.data.setUint16(this._position,i,0==this.$endian),this.position+=2,this._writeUint8Array(e,!1)},t.prototype.writeUTFBytes=function(t){this._writeUint8Array(this.encodeUTF8(t))},t.prototype.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},t.prototype._writeUint8Array=function(t,e){void 0===e&&(e=!0);var i=this._position,r=i+t.length;e&&this.validateBuffer(r),this.bytes.set(t,i),this.position=r},t.prototype.validate=function(t){var e=this._bytes.length;return e>0&&this._position+t<=e?!0:void console.error(1025)},t.prototype.validateBuffer=function(t){this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this._validateBuffer(t)},t.prototype.encodeUTF8=function(t){for(var e=0,i=this.stringToCodePoints(t),r=[];i.length>e;){var s=i[e++];if(this.inRange(s,55296,57343))this.encoderError(s);else if(this.inRange(s,0,127))r.push(s);else{var n=void 0,o=void 0;for(this.inRange(s,128,2047)?(n=1,o=192):this.inRange(s,2048,65535)?(n=2,o=224):this.inRange(s,65536,1114111)&&(n=3,o=240),r.push(this.div(s,Math.pow(64,n))+o);n>0;){var a=this.div(s,Math.pow(64,n-1));r.push(128+a%64),n-=1}}}return new Uint8Array(r)},t.prototype.decodeUTF8=function(t){for(var e,i=!1,r=0,s="",n=0,o=0,a=0,h=0;t.length>r;){var u=t[r++];if(u==this.EOF_byte)e=0!=o?this.decoderError(i):this.EOF_code_point;else if(0==o)this.inRange(u,0,127)?e=u:(this.inRange(u,194,223)?(o=1,h=128,n=u-192):this.inRange(u,224,239)?(o=2,h=2048,n=u-224):this.inRange(u,240,244)?(o=3,h=65536,n=u-240):this.decoderError(i),n*=Math.pow(64,o),e=null);else if(this.inRange(u,128,191))if(a+=1,n+=(u-128)*Math.pow(64,o-a),a!==o)e=null;else{var f=n,d=h;n=0,o=0,a=0,h=0,e=this.inRange(f,d,1114111)&&!this.inRange(f,55296,57343)?f:this.decoderError(i,u)}else n=0,o=0,a=0,h=0,r--,e=this.decoderError(i,u);null!==e&&e!==this.EOF_code_point&&(65535>=e?e>0&&(s+=String.fromCharCode(e)):(e-=65536,s+=String.fromCharCode(55296+(e>>10&1023)),s+=String.fromCharCode(56320+(1023&e))))}return s},t.prototype.encoderError=function(t){console.log(1026,t)},t.prototype.decoderError=function(t,e){return t&&console.log(1027),e||65533},t.prototype.inRange=function(t,e,i){return t>=e&&i>=t},t.prototype.div=function(t,e){return Math.floor(t/e)},t.prototype.stringToCodePoints=function(t){for(var e=[],i=0,r=t.length;i<t.length;){var s=t.charCodeAt(i);if(this.inRange(s,55296,57343))if(this.inRange(s,56320,57343))e.push(65533);else if(i==r-1)e.push(65533);else{var n=t.charCodeAt(i+1);if(this.inRange(n,56320,57343)){var o=1023&s,a=1023&n;i+=1,e.push(65536+(o<<10)+a)}else e.push(65533)}else e.push(s);i+=1}return e},t.prototype.compress=function(){var t=new Zlib.Deflate(new Uint8Array(this.buffer)),e=t.compress();this.buffer=e.buffer,this._position=0},t.prototype.uncompress=function(){var t=new Zlib.Inflate(new Uint8Array(this.buffer)),e=t.decompress();this.buffer=e.buffer,this._position=0},t.uncompress=function(t){var e=new Zlib.Inflate(new Uint8Array(t)),i=e.decompress();return i.buffer},t}();t.ByteArray=i,__reflect(i.prototype,"decoder.ByteArray")}(decoder||(decoder={}));var decoder;!function(t){var e=function(){function e(){}return e.prototype.decode=function(e,i,r,s){function n(){if(a.bytesAvailable){var e=a.readUTF(),h=a.readBoolean(),u=a.readBoolean(),f=a.readUnsignedInt();o=new t.ByteArray,a.readBytes(o,0,f),u&&(o.position=0,o=new t.ByteArray(t.ByteArray.uncompress(o.buffer)));var d=o.readUTFBytes(o.length);return h&&(d=d.replace(/\/\//g,"")),r.call(i,e,d),void setTimeout(n,1e3/60)}s.call(i)}var o,a=new t.ByteArray(e);n()},e}();t.ZlibDecoder=e,__reflect(e.prototype,"decoder.ZlibDecoder"),t.zlibDecoder=new e;var i=function(){function e(){}return e.prototype.decode=function(e){for(var i={},r=new t.ByteArray(e);r.bytesAvailable;){var s=new t.ByteArray,n=r.readUTF(),o=r.readInt();r.readBytes(s,0,o);var a=new amf.Deserializer(new Uint8Array(s.buffer));s.clear(),i[n]=a.readObject()}return r.clear(),e.clear(),i},e}();t.AMFDecoder=i,__reflect(i.prototype,"decoder.AMFDecoder"),t.amfDecoder=new i}(decoder||(decoder={}));